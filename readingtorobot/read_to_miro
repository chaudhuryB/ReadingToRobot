#!/usr/bin/python
#
# Main script for Reading With Robots and MiRo
#

import argparse
import logging
import os

from readingtorobot.MiRo import RobotManager
from readingtorobot.common import module_file


if __name__ == "__main__":

    logging.basicConfig(format='%(asctime)s:%(levelname)s:\033[32m%(name)s\033[0m: %(message)s', level=logging.DEBUG)

    parser = argparse.ArgumentParser()
    parser.add_argument('animation_dir', nargs='?', default=module_file(os.path.join('MiRo', 'animations')))
    parser.add_argument('-k', '--keyboard-control', action='store_true',
                        help="Trigger emotion animations manually using keyboard.")
    parser.add_argument("--mqttIP", type=str, default='127.0.0.1',
                        help="Ip of speech server.")
    args = parser.parse_args()

    # instantiate
    app = RobotManager(animation_dir=args.animation_dir, keyboard_control=args.keyboard_control, mqtt_ip=args.mqttIP)

    # execute
    app.loop()

    # terminate
    app.term()
